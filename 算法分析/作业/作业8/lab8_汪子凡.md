19-1

$D(n)$ 表示结点的最大度， $t(H) $ 表示根链表的长度



a. 第七步是将 $x$ 的孩子结点加到根链表中，加到根链表一定同删除最小值一样，要将度相同的结点合并(要不然根链表长度会很长)，删除 x 是 $O(1)$，而合并度相同的点则需要 $O(D(n) + t(H))$ 的复杂度，并不是 $O(1)$



b.拆出 $x$ 的孩子，根链表最多增加 $D(n) $个结点，进行 $c$ 次级联删除操作，根链表最多增加 $c - 1$ 个结点，则根链表此时长度为 $O(T(H) + D(n) + c - 1)$

删除 x 操作为 $O(1)$, $c$ 次级联删除为 $O(c)$, 合并根结点为 $O(T(H) + D(n) + c - 1)$

总复杂度上界为  $O(T(H) + D(n) + c)$



#### c. $Φ(H) = t(H) + 2m(H)$

对于删除之后的 $H'$, 根链表长度最多为 $O(D(n) + 1)$，由于进行 $c$ 次级联删除会减少 $c - 2 $ 个mark 结点(进行一次反而会增加一个mark)， 所以标记节点为 $m(H) - c + 2$

于是势函数 $Φ(H') = O(D(n) + 1 + 2(m(H) - c + 2)) = O(D(n) + 2m(H) - 2c + 5)$



d.

势函数变化  $Φ(H')  - Φ(H) = O(D(n) + 2m(H) - 2c + 5 - t(H) - 2m(H)) = O(D(n) - t(H) - 2c + 5) $

则摊还代价 $c' = O(T(H) + D(n) + c + (D(n) - t(H) - 2c + 5)) = O(2D(n) - c + 5)$ 

而之前的删除摊还代价为 $O(D(n))$ , 所以并没有更优